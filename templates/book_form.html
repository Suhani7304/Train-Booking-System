<!DOCTYPE html>
<html>
<head>
    <title>Passenger Details</title>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
    <style>
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            backdrop-filter: blur(5px);
            background-color: rgba(0, 0, 0, 0.3);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .confirmation-box {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: left;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            max-width: 400px;
            width: 90%;
        }
        .confirmation-box h2 {
            color: green;
            margin-top: 0;
        }
        .download-btn {
            background-color: #007BFF;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
        .download-btn:hover {
            background-color: #0056b3;
        }  
    </style>
</head>
<body>
    {% if confirmed %}
    <div class="overlay">
        <div class="confirmation-box">
            <h2>&#10004; Booking Confirmed!</h2>
            <p><strong>Name:</strong> {{ data.name }}</p>
            <p><strong>Train:</strong> {{ data.train_name }} ({{ data.train_id }})</p>
            <p><strong>From:</strong> {{ data.source }} to {{ data.destination }}</p>
            <p><strong>Date:</strong> {{ data.date }}</p>
            <p><strong>Seat Type:</strong> {{ data.seat_type }}</p>
            <p><strong>Price:</strong> â‚¹{{ data.price }}</p>

            <form method="POST" action="{{ url_for('download_ticket') }}">
                {% for key, value in data.items() %}
                    <input type="hidden" name="{{ key }}" value="{{ value }}">
                {% endfor %}
                <button class="download-btn" type="submit">Download Ticket</button>
            </form>
        </div>
    </div>
    {% endif %}

    <h2>Enter Passenger Details</h2>
    <form method="POST" action="/confirm_booking">
        <input type="hidden" name="train_id" value="{{ data.train_id }}">
        <input type="hidden" name="train_name" value="{{ data.train_name }}">
        <input type="hidden" name="source" value="{{ data.source }}">
        <input type="hidden" name="destination" value="{{ data.destination }}">
        <input type="hidden" name="arrival" value="{{ data.arrival }}">
        <input type="hidden" name="departure" value="{{ data.departure }}">
        <input type="hidden" name="route" value="{{ data.route }}">

        <label>Name:</label><input name="name" required><br>
        <label>Age:</label><input name="age" required><br>
        <label>Email:</label><input name="email" type="email" required><br>
        <label>Gender:</label>
        <select name="gender">
            <option>Male</option><option>Female</option><option>Other</option>
        </select><br>
        <label>Seat Type:</label>
        <select name="seat_type" onchange="updatePrice(this.value)">
            <option value="Sleeper (SL)" data-price="{{ data.SL }}">Sleeper (SL)</option>
            <option value="Chair Car (CC)" data-price="{{ data.CC }}">Chair Car (CC)</option>
            <option value="Third AC (3A)" data-price="{{ data.A3 }}">Third AC (3A)</option>
            <option value="Second AC (2A)" data-price="{{ data.A2 }}">Second AC (2A)</option>
            <option value="First AC (1A)" data-price="{{ data.A1 }}">First AC (1A)</option>
        </select><br>
        <input type="hidden" id="final_price" name="price" value="{{ data.general }}">
        <label>Travel Date:</label><input name="date" type="date" required><br>
        <label>Password:</label><input name="password" type="password" required><br>

        <button type="submit">Book Train</button>
    </form>
</body>
</html>
